local Luan = require "luan:Luan"
local assert = Luan.assert
local Io = require "luan:Io"
local Http = require "luan:web/Http"


local function print(...)
	Io.print_to(Io.stderr,...)
end

function Io.schemes.site(path,loading)
	return Io.Uri( "luan:web"..path, loading )
end


Http.init_for_test()
Http.request.parameters.code = "require('luan:Io').print 'hi'"
page = Http.get_page "/web_run"
assert( page.trim() == "hi" )

Http.init_for_test()
Http.request.parameters.cmd = "'ab'..'cd'"
page = Http.get_page "/web_shell"
assert( page.find "abcd" )
